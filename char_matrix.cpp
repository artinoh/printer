#include "char_matrix.h"
#include <sstream>
#include <iomanip>
#include <unistd.h>
#include <iostream>

char_matrix::char_matrix(const std::string& str)
{
    //m_string = to_lower(str);
    for (int i=0; i<str.length(); i++)
    {
        m_string += tolower(str[i]);
    }
    m_string += "  ";
    populate_chars();
    map_string();
}

void char_matrix::map_string()
{
    for (int i=0; i< m_string.length(); i++)
    {
        char c = m_string[i];
        auto it = m_char_map.find(c);
        if (it != m_char_map.end())
        {
            for (int j=0; j<size; j++)
            {  
                for (int k=0; k<size; k++)
                {
                    m_mapped_chars[j].push_back(it->second[j][k]);
                }
            }
        }
    }

    for (int i=0; i < m_print_buffer.size(); i++)
    {
        m_print_buffer[i].resize(m_mapped_chars[i].size(), ' ');
    }
}

void char_matrix::print_mapped_chars()
{
    for (int i=0; i<size; i++)
    {
        for (int j=0; j<m_print_buffer[i].size(); j++)
        {
            std::cout << m_print_buffer[i][j];
        }
        std::cout << '\n';
    }
}

void char_matrix::print_col(int col)
{
    std::stringstream ss;
    for (int i=0; i<size; i++)
    {
        ss << m_mapped_chars[i][col] << '\n';
    }
    std::cout << ss.str();
}


void char_matrix::print()
{
    for (int i=0; i < num_runs; i++)
    {
        while (m_current_col < m_mapped_chars[0].size())
        {
            add_col_to_print_buffer();
            usleep(70000);
            system("clear");
            print_mapped_chars();
            shift_print_buffer();
        }
        m_current_col = 0;
    }
}

void char_matrix::shift_print_buffer()
{
    for (int i=0; i < m_print_buffer.size(); i++)
    {
        for (int j=0; j < m_print_buffer[i].size(); j++)
        {
            if (j == m_print_buffer[i].size() - 1)
            {
                m_print_buffer[i][j] = ' ';
            }
            else
            {
                m_print_buffer[i][j] = m_print_buffer[i][j+1];
            }
        }
    }
}

void char_matrix::add_col_to_print_buffer()
{
    //add m_mapped_chars[m_current_col] to last column of m_print_buffer
    for (int i=0; i < m_print_buffer.size(); i++)
    {
        m_print_buffer[i][m_print_buffer[i].size() - 1] = m_mapped_chars[i][m_current_col];
    }
    m_current_col++;
}

void char_matrix::add_space_to_print_buffer()
{
    for (int i=0; i < m_print_buffer.size(); i++)
    {
        m_print_buffer[i][m_print_buffer[i].size() - 1] = ' ';
    }
}
void char_matrix::populate_chars()
{
    // k m 
    m_char_map['a'] = {{
        {' ', ' ', ' ', '*', '*', '*', ' ', ' '},
        {' ', ' ', '*', ' ', ' ', ' ', '*', ' '},
        {' ', '*', ' ', ' ', ' ', ' ', ' ', '*'},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'},
        {'*', '*', '*', '*', '*', '*', '*', '*'},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'}
    }};

    m_char_map['b'] = {{
        {'*', '*', '*', '*', '*', '*', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', '*', '*', '*', '*', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', '*', '*', '*', '*', '*', ' ', ' '}
    }};

    m_char_map['c'] = {{
        {' ', '*', '*', '*', '*', '*', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {' ', '*', '*', '*', '*', '*', '*', ' '}
    }};

    m_char_map['d'] = {{
        {'*', '*', '*', '*', '*', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', '*', '*', '*', '*', '*', ' ', ' '}
    }};

    m_char_map['e'] = {{
        {'*', '*', '*', '*', '*', '*', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', '*', '*', '*', '*', '*', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', '*', '*', '*', '*', '*', '*', ' '}
    }};

    m_char_map['f'] = {{
        {'*', '*', '*', '*', '*', '*', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', '*', '*', '*', '*', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '}
    }};

    m_char_map['g'] = {{
        {' ', '*', '*', '*', '*', '*', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', '*', '*', '*', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', '*', ' ', ' '},
        {' ', '*', '*', '*', '*', ' ', ' ', ' '}
    }};

    m_char_map['h'] = {{
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', '*', '*', '*', '*', '*', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '}
    }};

    m_char_map['i'] = {{
        {'*', '*', '*', '*', '*', '*', '*', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {'*', '*', '*', '*', '*', '*', '*', ' '}
    }};

    m_char_map['j'] = {{
        {' ', ' ', ' ', '*', '*', '*', '*', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', '*', '*', '*', '*', '*', ' ', ' '}
    }};

    m_char_map['k'] = {{
        {'*', ' ', ' ', ' ', '*', '*', ' ', ' '},
        {'*', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {'*', ' ', '*', ' ', ' ', ' ', ' ', ' '},
        {'*', '*', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', '*', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', '*', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', '*', ' ', ' '}
    }};

    m_char_map['l'] = {{
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', '*', '*', '*', '*', '*', '*', ' '}
    }};

    m_char_map['m'] = {{
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'},
        {'*', '*', ' ', ' ', ' ', ' ', '*', '*'},
        {'*', ' ', '*', ' ', ' ', '*', ' ', '*'},
        {'*', ' ', ' ', '*', '*', ' ', ' ', '*'},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'}
    }};

    m_char_map['n'] = {{
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'},
        {'*', '*', ' ', ' ', ' ', ' ', ' ', '*'},
        {'*', ' ', '*', ' ', ' ', ' ', ' ', '*'},
        {'*', ' ', ' ', '*', ' ', ' ', ' ', '*'},
        {'*', ' ', ' ', ' ', '*', ' ', ' ', '*'},
        {'*', ' ', ' ', ' ', ' ', '*', ' ', '*'},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', '*'},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', '*'},
    }};

    m_char_map['o'] = {{
        {' ', '*', '*', '*', '*', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', '*', '*', '*', '*', '*', ' ', ' '},
    }};

    m_char_map['p'] = {{
        {'*', '*', '*', '*', '*', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', '*', '*', '*', '*', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '}
    }};

    m_char_map['q'] = {{
        {' ', '*', '*', '*', '*', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', '*', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', '*', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', '*', '*', '*', '*', '*', ' ', '*'},
    }};

    m_char_map['r'] = {{
        {'*', '*', '*', '*', '*', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', '*', '*', '*', '*', '*', ' ', ' '},
        {'*', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', '*', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
    }};

    m_char_map['s'] = {{
        {' ', '*', '*', '*', '*', '*', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {' ', '*', '*', '*', '*', '*', ' ', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', '*', '*', '*', '*', '*', ' ', ' '},
    }};

    // letter t
    m_char_map['t'] = {{
        {'*', '*', '*', '*', '*', '*', '*', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '}
    }};

    // letter u
    m_char_map['u'] = {{
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', '*', '*', '*', '*', '*', '*', ' '}
    }};

    // letter v
    m_char_map['v'] = {{
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', '*', ' ', ' ', ' ', '*', ' ', ' '},
        {' ', '*', ' ', ' ', ' ', '*', ' ', ' '},
        {' ', ' ', '*', ' ', '*', ' ', ' ', ' '},
        {' ', ' ', '*', ' ', '*', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '}
    }};

    // letter w
    m_char_map['w'] = {{
        {'*', ' ', ' ', '*', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', '*', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', '*', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', '*', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', '*', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', '*', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', '*', ' ', ' ', '*', ' '},
        {'*', '*', '*', '*', '*', '*', '*', ' '},
    }};

    // letter x
    m_char_map['x'] = {{
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', '*', ' ', ' ', ' ', '*', ' ', ' '},
        {' ', ' ', '*', '*', '*', ' ', ' ', ' '},
        {' ', ' ', '*', '*', '*', ' ', ' ', ' '},
        {' ', '*', ' ', ' ', ' ', '*', ' ', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}
    }};

    // letter y
    m_char_map['y'] =
    {{
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {'*', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', '*', ' ', ' ', ' ', '*', ' ', ' '},
        {' ', ' ', '*', ' ', '*', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '}
    }};

    // letter z
    m_char_map['z'] =
    {{
        {'*', '*', '*', '*', '*', '*', '*', '*'},
        {' ', ' ', ' ', ' ', ' ', ' ', '*', ' '},
        {' ', ' ', ' ', ' ', ' ', '*', ' ', ' '},
        {' ', ' ', ' ', ' ', '*', ' ', ' ', ' '},
        {' ', ' ', ' ', '*', ' ', ' ', ' ', ' '},
        {' ', ' ', '*', ' ', ' ', ' ', ' ', ' '},
        {' ', '*', ' ', ' ', ' ', ' ', ' ', ' '},
        {'*', '*', '*', '*', '*', '*', '*', '*'},
    }};

    // letter space
    m_char_map[' '] =
    {{
        {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}
    }};

    m_char_map['!'] = 
    {{
        {' ', '*', ' ', '*', ' ', '*', ' ', ' '},
        {' ', '*', ' ', '*', ' ', '*', ' ', ' '},
        {' ', '*', ' ', '*', ' ', '*', ' ', ' '},
        {' ', '*', ' ', '*', ' ', '*', ' ', ' '},
        {' ', '*', ' ', '*', ' ', '*', ' ', ' '},
        {' ', '*', ' ', '*', ' ', '*', ' ', ' '},
        {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '},
        {' ', '*', ' ', '*', ' ', '*', ' ', ' '}
    }};

}
